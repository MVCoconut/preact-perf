{"version":3,"sources":["preact-router.js"],"names":[],"mappings":"84CAEA,IAAM,OAAO,CAAG,EAAE,CAAC,AAEZ,SAAS,KAAK,CAAC,GAAG,CAAE,CAC1B,GAAI,OAAO,CAAE,CACZ,OAAO,CAAC,SAAS,CAAC,IAAI,CAAE,IAAI,CAAE,GAAG,CAAC,CAAC,CACnC,AACD,OAAO,CAAC,GAAG,CAAC,CAAC,CACb,AAED,SAAS,OAAO,CAAC,GAAG,CAAE,CACrB,OAAO,CAAC,OAAO,CAAE,SAAA,MAAM,SAAI,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,EAAA,CAAE,CAAC,CACjD,AAED,SAAS,aAAa,EAAG,CACxB,aAAU,QAAQ,CAAC,QAAQ,IAAI,EAAE,CAAA,IAAG,QAAQ,CAAC,MAAM,IAAI,EAAE,CAAA,CAAG,CAC5D,AAED,GAAI,OAAO,gBAAgB,KAAG,UAAU,CAAE,CACzC,gBAAgB,CAAC,UAAU,CAAE,kBAAM,OAAO,CAAC,aAAa,EAAE,CAAC,EAAA,CAAC,CAAC,CAC7D,AAGD,SAAS,eAAe,CAAC,CAAC,CAAE,CAC3B,KAAK,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,AACjC,GAAI,CAAC,CAAC,wBAAwB,CAAE,CAAC,CAAC,wBAAwB,EAAE,CAAC,AAC7D,CAAC,CAAC,eAAe,EAAE,CAAC,AACpB,CAAC,CAAC,cAAc,EAAE,CAAC,AACnB,OAAO,KAAK,CAAC,CACb,AAGM,IAAM,IAAI,CAAG,SAAP,IAAI,CAAI,IAAsB,MAApB,QAAQ,CAAV,IAAsB,CAApB,QAAQ,KAAK,KAAK,0BAApB,IAAsB,sBAC1C,QAlCQ,CAAC,iBAkCF,KAAK,EAAE,OAAO,CAAG,eAAe,AAAE,GAAG,QAAQ,CAAM,EAC1D,CAAC,wBAGW,MAAM,iCAAN,MAAM,sBAAN,MAAM,wBAAN,MAAM,oCAAN,MAAM,WAClB,eAAe,GAAA,0BAAG,CACjB,OAAO,CAAE,GAAG,CAAE,aAAa,EAAE,CAAE,CAAC,CAChC,CAHW,MAAM,WAKlB,OAAO,GAAA,iBAAC,GAAG,CAAE,CACZ,IAAI,CAAC,QAAQ,CAAC,CAAE,GAAG,CAAH,GAAG,CAAE,CAAC,CAAC,CACvB,CAPW,MAAM,WASlB,kBAAkB,GAAA,6BAAG,CACpB,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CACnB,CAXW,MAAM,WAalB,oBAAoB,GAAA,+BAAG,CACtB,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAE,CAAC,CAAC,CAAC,CACzC,CAfW,MAAM,WAiBlB,MAAM,GAAA,gBAAC,KAAsB,CAAE,KAAO,CAAE,KAA/B,QAAQ,CAAV,KAAsB,CAApB,QAAQ,KAAE,QAAQ,CAApB,KAAsB,CAAV,QAAQ,KAAM,GAAG,CAAL,KAAO,CAAL,GAAG,CACnC,IAAI,MAAM,CAAG,QAAQ,CAAC,MAAM,CAAE,SAAC,KAAc,CAAK,KAAjB,UAAU,CAAZ,KAAc,CAAZ,UAAU,CAC1C,IAAI,IAAI,CAAG,UAAU,CAAC,IAAI,CACzB,OAAO,CAAG,IAAI,CAAC,GAAG,CAAE,IAAI,CAAC,CAAC,AAC3B,GAAI,OAAO,CAAE,CACZ,UAAU,CAAC,GAAG,GAAG,GAAG,CAAC,AACrB,UAAU,CAAC,OAAO,GAAG,OAAO,CAAC,AAE7B,IAAK,IAAI,CAAC,IAAI,OAAO,EAAE,CACtB,GAAI,OAAO,CAAC,cAAc,CAAC,CAAC,CAAC,CAAE,CAC9B,UAAU,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,CAAC,CAAC,CAAC,CAC3B,CACD,AACD,OAAO,IAAI,CAAC,CACZ,CACD,CAAC,CAAC,AACH,IAAI,QAAQ,CAAG,IAAI,CAAC,WAAW,CAAC,AAChC,GAAI,GAAG,KAAG,QAAQ,CAAE,CACnB,IAAI,CAAC,WAAW,GAAG,GAAG,CAAC,AACvB,GAAI,OAAO,QAAQ,KAAG,UAAU,CAAE,CACjC,QAAQ,CAAC,CACR,MAAM,CAAE,IAAI,CACZ,GAAG,CAAH,GAAG,CACH,QAAQ,CAAR,QAAQ,CACR,MAAM,CAAN,MAAM,CACN,OAAO,CAAE,MAAM,CAAC,CAAC,CAAC,CAClB,CAAC,CAAC,CACH,CACD,AACD,OAAO,MAAM,CAAC,CAAC,CAAC,IAAI,IAAI,CAAC,CACzB,QA/CW,MAAM,YAtCP,SAAS,0BAyFd,IAAM,KAAK,CAAG,SAAR,KAAK,CAAI,KAA2C,MAA/B,eAAe,CAA3B,KAA2C,CAAzC,SAAS,KAAkB,GAAG,CAAhC,KAA2C,CAAd,GAAG,KAAE,OAAO,CAAzC,KAA2C,CAAT,OAAO,QAC9D,QA1FQ,CAAC,CA0FR,eAAe,CAAK,CAAC,GAAG,CAAH,GAAG,CAAE,OAAO,CAAP,OAAO,CAAC,CAAI,EACvC,CAAC,sBAWF,SAAS,IAAI,CAAC,GAAG,CAAE,KAAK,CAAE,CACzB,IAAI,GAAG,CAAG,uBAAuB,CAChC,CAAC,CAAG,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAClB,OAAO,CAAG,EAAE,CAAC,AACd,GAAI,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,CAAE,CACd,IAAI,CAAC,CAAG,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,AACxB,IAAK,IAAI,CAAC,CAAC,CAAC,CAAE,CAAC,GAAC,CAAC,CAAC,MAAM,CAAE,CAAC,EAAE,EAAE,CAC9B,IAAI,CAAC,CAAG,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,AACxB,OAAO,CAAC,kBAAkB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,kBAAkB,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAC7E,CACD,AACD,GAAG,GAAG,UAAU,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAE,EAAE,CAAC,CAAC,CAAC,AACvC,KAAK,GAAG,UAAU,CAAC,KAAK,CAAC,CAAC,AAC1B,IAAI,GAAG,CAAG,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,MAAM,CAAE,KAAK,CAAC,MAAM,CAAC,CAAC,AAC7C,IAAK,IAAI,CAAC,CAAC,CAAC,CAAE,CAAC,GAAC,GAAG,CAAE,CAAC,EAAE,EAAE,CACzB,GAAI,KAAK,CAAC,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,CAAC,CAAC,KAAG,GAAG,CAAE,CACzC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,GAAG,kBAAkB,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAClE,KACI,CACJ,GAAI,KAAK,CAAC,CAAC,CAAC,KAAG,GAAG,CAAC,CAAC,CAAC,CAAE,CACtB,OAAO,KAAK,CAAC,CACb,CACD,CACD,AACD,OAAO,OAAO,CAAC,CACf,AAGD,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,AACrB,MAAM,CAAC,KAAK,GAAG,KAAK,CAAC,AACrB,MAAM,CAAC,IAAI,GAAG,IAAI,CAAC,qBACJ,MAAM,CAGrB,IAAI,UAAU,CAAG,SAAb,UAAU,CAAG,GAAG,SAAI,KAAK,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,EAAA,CAAC,AAE9C,IAAI,KAAK,CAAG,SAAR,KAAK,CAAG,GAAG,SAAI,GAAG,CAAC,OAAO,CAAC,cAAc,CAAE,EAAE,CAAC,EAAA,CAAC","file":"preact-router.js","sourcesContent":["import { h, Component } from 'preact';\n\nconst routers = [];\n\nexport function route(url) {\n\tif (history) {\n\t\thistory.pushState(null, null, url);\n\t}\n\trouteTo(url);\n}\n\nfunction routeTo(url) {\n\trouters.forEach( router => router.routeTo(url) );\n}\n\nfunction getCurrentUrl() {\n\treturn `${location.pathname || ''}${location.search || ''}`;\n}\n\nif (typeof addEventListener==='function') {\n\taddEventListener('popstate', () => routeTo(getCurrentUrl()));\n}\n\n\nfunction handleLinkClick(e) {\n\troute(this.getAttribute('href'));\n\tif (e.stopImmediatePropagation) e.stopImmediatePropagation();\n\te.stopPropagation();\n\te.preventDefault();\n\treturn false;\n}\n\n\nexport const Link = ({ children, ...props }) => (\n\t<a {...props} onClick={ handleLinkClick }>{ children }</a>\n);\n\n\nexport class Router extends Component {\n\tgetInitialState() {\n\t\treturn { url: getCurrentUrl() };\n\t}\n\n\trouteTo(url) {\n\t\tthis.setState({ url });\n\t}\n\n\tcomponentWillMount() {\n\t\trouters.push(this);\n\t}\n\n\tcomponentWillUnmount() {\n\t\trouters.splice(routers.indexOf(this), 1);\n\t}\n\n\trender({ children, onChange }, { url }) {\n\t\tlet active = children.filter( ({ attributes }) => {\n\t\t\tlet path = attributes.path,\n\t\t\t\tmatches = exec(url, path);\n\t\t\tif (matches) {\n\t\t\t\tattributes.url = url;\n\t\t\t\tattributes.matches = matches;\n\t\t\t\t// copy matches onto props\n\t\t\t\tfor (let i in matches) {\n\t\t\t\t\tif (matches.hasOwnProperty(i)) {\n\t\t\t\t\t\tattributes[i] = matches[i];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t});\n\t\tlet previous = this.previousUrl;\n\t\tif (url!==previous) {\n\t\t\tthis.previousUrl = url;\n\t\t\tif (typeof onChange==='function') {\n\t\t\t\tonChange({\n\t\t\t\t\trouter: this,\n\t\t\t\t\turl,\n\t\t\t\t\tprevious,\n\t\t\t\t\tactive,\n\t\t\t\t\tcurrent: active[0]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn active[0] || null;\n\t}\n}\n\n\nexport const Route = ({ component:RoutedComponent, url, matches }) => (\n\t<RoutedComponent {...{url, matches}} />\n);\n\n/*\nexport class Route extends Component {\n\trender({ component:RoutedComponent, url, matches }) {\n\t\treturn <RoutedComponent { ...{url, matches} } />;\n\t}\n}\n*/\n\n\nfunction exec(url, route) {\n\tlet reg = /(?:\\?([^#]*))?(#.*)?$/,\n\t\tc = url.match(reg),\n\t\tmatches = {};\n\tif (c && c[1]) {\n\t\tlet p = c[1].split('&');\n\t\tfor (let i=0; i<p.length; i++) {\n\t\t\tlet r = p[i].split('=');\n\t\t\tmatches[decodeURIComponent(r[0])] = decodeURIComponent(r.slice(1).join('='));\n\t\t}\n\t}\n\turl = segmentize(url.replace(reg, ''));\n\troute = segmentize(route);\n\tlet max = Math.max(url.length, route.length);\n\tfor (let i=0; i<max; i++) {\n\t\tif (route[i] && route[i].charAt(0)===':') {\n\t\t\tmatches[route[i].substring(1)] = decodeURIComponent(url[i] || '');\n\t\t}\n\t\telse {\n\t\t\tif (route[i]!==url[i]) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\treturn matches;\n}\n\n\nRouter.route = route;\nRouter.Route = Route;\nRouter.Link = Link;\nexport default Router;\n\n\nlet segmentize = url => strip(url).split('/');\n\nlet strip = url => url.replace(/(^\\/+|\\/+$)/g, '');\n"]}